<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ESL Class Timer</title>
<style>
:root {
  --red:#c4161c;
  --blue:#003a8f;
  --light:#f5f7fa;
}
body {
  margin:0;
  padding:1rem;
  font-family:system-ui,sans-serif;
  background:var(--light);
}
header {
  text-align:center;
  margin-bottom:1rem;
}
h1{color:var(--red); margin:0.3rem 0;}
#branch{color:var(--blue); font-weight:600;}

.container {
  display:flex;
  gap:1rem;
}
.panel {
  background:white;
  border-radius:12px;
  padding:1rem;
  flex:1;
  border-top:5px solid var(--red);
}

#timer{
  font-size:4rem;
  color:var(--blue);
  margin:1rem 0;
}

.warning{
  color:var(--red);
  animation:blink 1s infinite;
}

@keyframes blink{
  50%{opacity:0;}
}

button{
  width:100%;
  margin:0.3rem 0;
  padding:0.6rem;
  font-size:1rem;
  border:none;
  border-radius:8px;
  background:var(--blue);
  color:white;
  cursor:pointer;
}

button.red{background:var(--red);}

.activity{
  display:flex;
  gap:0.4rem;
  margin-bottom:0.4rem;
  padding:0.3rem;
  border-radius:6px;
  background:#e3f1ff;
  align-items:center;
}

.break{background:#ffe5e5;}

.activity input[type="text"]{flex:1;}
.activity input[type="number"]{width:60px;}

.progress{
  height:20px;
  background:#ddd;
  border-radius:10px;
  overflow:hidden;
}
.bar{
  height:100%;
  background:var(--blue);
  width:100%;
}

@media(max-width:768px){
  .container{flex-direction:column;}
  #timer{font-size:3rem;}
}
</style>
</head>

<body>

<header>
  <h1>ESL Class Timer</h1>
  <div id="branch">VUS Hoa Binh Campus</div>
</header>

<div class="container">

<div class="panel">
  <h3>Lesson Templates</h3>
  <button onclick="loadTemplate(90)">90 minutes</button>
  <button onclick="loadTemplate(120)">120 minutes</button>

  <h3>Lesson</h3>
  <button class="red" onclick="saveLesson()">Save lesson</button>
  <button onclick="loadLesson()">Load lesson</button>

  <h3>Activities</h3>
  <div id="activities"></div>
  <button onclick="addActivity()">âž• Add Activity</button>
  <button onclick="addBreak()">â˜• Break</button>
</div>

<div class="panel" style="text-align:center;">
  <h2 id="current">Ready</h2>
  <div id="timer">00:00</div>
  <div class="progress">
    <div id="bar" class="bar"></div>
  </div>
  <button onclick="start()">Start</button>
  <button onclick="pause()">Pause</button>
  <button onclick="next()">Next</button>
</div>

</div>

<audio id="ding" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>

<script>
let activities=[];
let index=0;
let remaining=0;
let total=0;
let interval=null;

const actDiv=document.getElementById("activities");
const timerEl=document.getElementById("timer");
const bar=document.getElementById("bar");
const current=document.getElementById("current");
const ding=document.getElementById("ding");

function render(){
  actDiv.innerHTML="";
  activities.forEach((a,i)=>{
    const d=document.createElement("div");
    d.className="activity"+(a.break?" break":"");
    d.innerHTML=`
      <input type="text" value="${a.name}">
      <input type="number" min="5" max="80" value="${a.min}">
      <button>ðŸ¦„</button>
    `;
    d.querySelectorAll("input")[0].onchange=e=>a.name=e.target.value;
    d.querySelectorAll("input")[1].onchange=e=>a.min=+e.target.value;
    d.querySelector("button").onclick=()=>{
      activities.splice(i,1);
      render();
    };
    actDiv.appendChild(d);
  });
}

function update(){
  const m=Math.floor(remaining/60);
  const s=remaining%60;
  timerEl.textContent=`${m}:${s.toString().padStart(2,"0")}`;
  bar.style.width=`${remaining/total*100}%`;
  if(remaining<=120) timerEl.classList.add("warning");
  else timerEl.classList.remove("warning");
}

function start(){
  if(interval||!activities[index])return;
  remaining=activities[index].min*60;
  total=remaining;
  current.textContent=activities[index].name;
  interval=setInterval(()=>{
    remaining--;
    update();
    if(remaining<=0){
      clearInterval(interval);
      interval=null;
      ding.play();
      next();
    }
  },1000);
}

function pause(){
  clearInterval(interval);
  interval=null;
}

function next(){
  pause();
  index++;
  if(activities[index]) start();
  else current.textContent="Class finished ðŸŽ‰";
}

function addActivity(){
  activities.push({name:"New Activity",min:10});
  render();
}

function addBreak(){
  activities.push({name:"Break",min:10,break:true});
  render();
}

function saveLesson(){
  localStorage.setItem("lesson",JSON.stringify(activities));
  alert("Lesson saved âœ”");
}

function loadLesson(){
  const s=localStorage.getItem("lesson");
  if(!s) return alert("No saved lesson");
  activities=JSON.parse(s);
  index=0;
  render();
}

function loadTemplate(t){
  index=0;
  activities = t===90 ? [
    {name:"Warm-up",min:10},
    {name:"Vocabulary",min:20},
    {name:"Break",min:10,break:true},
    {name:"Speaking",min:30},
    {name:"Game / Review",min:20}
  ] : [
    {name:"Warm-up",min:10},
    {name:"Vocabulary",min:25},
    {name:"Listening",min:25},
    {name:"Break",min:10,break:true},
    {name:"Speaking",min:30},
    {name:"Game / Review",min:20}
  ];
  render();
}
</script>

</body>
</html>

